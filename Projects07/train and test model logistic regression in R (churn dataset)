library(caret)
library(tidyverse)
## read churn.csv
churn <- read.csv("churn.csv")

#preview
head(churn)
view(churn)


## 1. spit data
n <- nrow(churn)
train_id <- sample(1:n, 0.8*n)
train_data <- churn[train_id, ]
test_data <- churn[-train_id, ]
## check nrows train_data and test_data
nrow(train_data)
nrow(test_data)

## build function
train_test_split <- function(data) {
  set.seed(42)
  n <- nrow(churn)
  train_id <- sample(1:n, 0.8*n)
  train_data <- churn[train_id, ]
  test_data <- churn[-train_id, ]
  return(list(train_data, test_data) ) 
}

## print train_test_split 
train_test_split(churn)

## call function
prep_data <- train_test_split(churn)
## check prep_data
prep_data[[1]]
prep_data[[2]]

## 2.train model
set.seed(42)
ctrl <- trainControl(method = "cv", 
                     number = 5)

model <- train(churn ~ .,
                   data = prep_data[[1]],
                   method = "glm",
                   trControl = ctrl)

## print model
model

## 3. score model
pred_churn_glm <- predict(model, newdata = prep_data[[2]])

## print pred_churn_glm
pred_churn_glm

## 4. evaluate model
actual_churn <- prep_data[[2]]$churn

## print actual_churn
actual_churn

##find error values 
mean(pred_churn_glm == actual_churn)

## output
150            12.91             11.1              4
166            10.29             12.1              2
172             7.41             10.6              5
173            12.10             10.5              4
176             7.69             11.1              7
177             8.78             12.2              3
178             8.78             11.5              3
181            12.70              9.5              5
183             7.65              9.9             12
192            10.71              9.5              2
193             9.37              8.8              4
198             8.18             10.7              6
200            11.06             13.0              3
206             8.57             12.1              2
212             8.74             11.9             11
223             9.91              4.4              2
226            11.25              2.7              4
230             7.35             11.9              3
234             6.94             10.9              2
241             8.79             12.9              5
243            12.41              8.4              2
246             9.10              9.5              5
247            11.78             11.1              3
248            12.75             10.2              5
250            10.28             11.8              4
253             7.76              9.1              8
257            10.42              9.8              3
260             7.62              8.7              4
263             8.33             11.5              3
274             9.14             13.0              3
277             9.15             11.1              4
281             8.47             13.0              4
282             8.70             10.4              6
283             6.48             12.2              1
    totalintlcharge numbercustomerservicecalls
5              2.73                          3
11             3.43                          4
21             2.86                          0
22             1.54                          5
24             2.08                          2
28             3.97                          3
37             3.92                          0
40             3.00                          1
42             3.94                          0
52             1.84                          1
76             1.65                          1
77             3.16                          0
85             3.35                          2
88             3.24                          1
106            3.19                          4
117            3.83                          1
128            1.73                          4
129            2.48                          2
133            2.57                          1
145            3.81                          2
148            3.16                          1
150            3.00                          2
166            3.27                          2
172            2.86                          2
173            2.84                          3
176            3.00                          2
177            3.29                          0
178            3.11                          2
181            2.57                          4
183            2.67                          2
192            2.57                          1
193            2.38                          2
198            2.89                          2
200            3.51                          0
206            3.27                          1
212            3.21                          0
223            1.19                          1
226            0.73                          1
230            3.21                          0
234            2.94                          0
241            3.48                          0
243            2.27                          1
246            2.57                          0
247            3.00                          0
248            2.75                          0
250            3.19                          2
253            2.46                          3
257            2.65                          1
260            2.35                          1
263            3.11                          1
274            3.51                          3
277            3.00                          0
281            3.51                          2
282            2.81                          2
283            3.29                          1
 [ reached 'max' / getOption("max.print") -- omitted 945 rows ]

> 
> ## call function
> prep_data <- train_test_split(churn)
> ## check prep_data
> prep_data[[1]]
     churn accountlength internationalplan voicemailplan
2609    No            81                no           yes
4069    No           148                no            no
2369    No            90                no            no
1098    No            57                no           yes
1252    No            87                no            no
634     No           122                no           yes
2097    No            94                no           yes
3911    No            51                no           yes
356     No            31                no            no
4261    No           238                no            no
3954    No            42               yes            no
1903    No            85                no            no
899     No           125                no            no
4697    No            74                no           yes
932     No            77                no            no
997     No           179                no            no
2015    No            87                no            no
4717    No            57                no           yes
4002    No            54                no           yes
860    Yes            93                no            no
3944    No            86               yes           yes
259    Yes            92               yes            no
481     No           166                no            no
2072    No           132                no            no
299     No           113                no            no
3983    No           115                no            no
2454    No           134                no           yes
3720    No            69                no            no
836     No            27                no            no
982     No           103                no           yes
1540    No           128               yes            no
2274    No            48                no            no
2552    No           102                no            no
3427    No            45                no            no
3032    No            64               yes            no
727     No            82                no            no
945    Yes            81                no           yes
3317    No           103                no           yes
626     No            97                no            no
4358    No           124                no            no
4226   Yes            78               yes            no
1396    No           103                no            no
4470    No           130                no            no
2818    No            90                no            no
1015    No           102                no            no
4746    No            78                no           yes
517     No            96                no            no
33      No           172                no            no
4964    No            47               yes           yes
103     No           135                no            no
2157    No            75                no            no
1353    No           136                no           yes
1693   Yes            79                no            no
4172   Yes            36               yes           yes
3619    No            94                no            no
     numbervmailmessages totaldayminutes totaldaycalls
2609                  46           168.3           124
4069                   0           249.7            91
2369                   0           246.4            83
1098                  29           279.9           121
1252                   0           169.1           105
634                   34           146.4           104
2097                  28           233.2            88
3911                  43           158.2            94
356                    0           166.1           105
4261                   0           202.0            60
3954                   0           260.9            94
1903                   0           210.3            66
899                    0           140.1           132
4697                  24           124.2           146
932                    0            67.7            68
997                    0           116.1           101
2015                   0           184.5            81
4717                  25           182.4            92
4002                  28           217.4            98
860                    0           267.9           114
3944                  41           225.5            95
259                    0            62.6           111
481                    0           181.4           108
2072                   0           181.1           121
299                    0           215.5           129
3983                   0           254.8            97
2454                  38           214.4            93
3720                   0           243.3           101
836                    0            72.7            75
982                   24           111.8            85
1540                   0           245.2           112
2274                   0           171.9            98
2552                   0           129.5            56
3427                   0           126.8            83
3032                   0           146.7            83
727                    0           143.7           116
945                   28           167.9           147
3317                  29           164.1           111
626                    0           144.2            91
4358                   0            94.8           102
4226                   0            71.5           126
1396                   0           189.8           110
4470                   0           211.4            91
2818                   0            61.3            91
1015                   0           114.8           125
4746                  38           199.0            96
517                    0            98.2           100
33                     0           212.0           121
4964                  31           140.6           114
103                    0           151.7            82
2157                   0           224.7           116
1353                  16            90.4           105
1693                   0           268.3           114
4172                  19           171.9            96
3619                   0           114.4           115
     totaldaycharge totaleveminutes totalevecalls
2609          28.61           270.9           103
4069          42.45           185.1            90
2369          41.89           160.3            88
1098          47.58           223.1           109
1252          28.75           169.9           102
634           24.89            89.7           103
2097          39.64           113.3           102
3911          26.89           213.2           105
356           28.24            79.3            93
4261          34.34           213.9           105
3954          44.35           152.8           123
1903          35.75           195.8            76
899           23.82           209.6           126
4697          21.11           266.2            84
932           11.51           195.7            86
997           19.74           201.8            99
2015          31.37           172.0           103
4717          31.01           214.7           104
4002          36.96           246.2           120
860           45.54           223.0            74
3944          38.34           229.3           101
259           10.64           180.6           126
481           30.84           253.8            54
2072          30.79           314.4           109
299           36.64           218.7           117
3983          43.32           153.5           110
2454          36.45           211.7            57
3720          41.36           109.2            99
836           12.36           208.6           117
982           19.01           239.6           102
1540          41.68           101.5           101
2274          29.22           159.0           127
2552          22.02           354.2           118
3427          21.56           157.8           100
3032          24.94           148.3            91
727           24.43           170.7            99
945           28.54           190.7           105
3317          27.90           219.1            96
626           24.51           226.7           137
4358          16.12           238.9            91
4226          12.16           166.8           127
1396          32.27           115.5            83
4470          35.94           191.0            62
2818          10.42           194.4            94
1015          19.52            81.9           126
4746          33.83            75.5            93
517           16.69           307.2            88
33            36.04            31.2           115
4964          23.90           264.6            44
103           25.79           119.0           105
2157          38.20           192.0            79
1353          15.37           201.3           109
1693          45.61           185.5           111
4172          29.22           198.4           111
3619          19.45           183.9            79
     totalevecharge totalnightminutes totalnightcalls
2609          23.03             222.5              98
4069          15.73             234.2              88
2369          13.63             170.9              99
1098          18.96             251.7              94
1252          14.44             244.9             106
634            7.62             220.0              91
2097           9.63             118.0              71
3911          18.12             190.4              91
356            6.74             213.7              98
4261          18.18             266.4              90
3954          12.99             212.6              94
1903          16.64             221.6              82
899           17.82             264.1              77
4697          22.63             156.7             108
932           16.63             236.5             137
997           17.15             181.9             103
2015          14.62             183.4              96
4717          18.25             174.4             110
4002          20.93             127.0              92
860           18.96             262.7              90
3944          19.49             134.0              82
259           15.35             221.7              80
481           21.57             112.3              94
2072          26.72             246.7              81
299           18.59             207.1              91
3983          13.05             217.6             117
2454          17.99             165.0              79
3720           9.28             176.9             138
836           17.73              65.8              71
982           20.37             268.3              81
1540           8.63             152.3             116
2274          13.52             139.5             101
2552          30.11             145.5              93
3427          13.41             158.3              97
3032          12.61             238.6              69
727           14.51             287.7              95
945           16.21             193.0             103
3317          18.62             220.3             108
626           19.27             144.6              72
4358          20.31             279.4              94
4226          14.18             211.6              86
1396           9.82             191.3             103
4470          16.24             207.3             109
2818          16.52             143.1              80
1015           6.96             304.3             101
4746           6.42             180.2              78
517           26.11             182.5             120
33             2.65             293.3              78
4964          22.49             238.7             121
103           10.12             180.0             100
2157          16.32             212.2              98
1353          17.11             227.1             115
1693          15.77             264.6              88
4172          16.86             321.7              76
3619          15.63             205.2              78
     totalnightcharge totalintlminutes totalintlcalls
2609            10.01              6.7              2
4069            10.54             10.5              1
2369             7.69              7.6              7
1098            11.33             13.0              2
1252            11.02              9.9             10
634              9.90             15.6              4
2097             5.31             16.1              4
3911             8.57              8.5              2
356              9.62             12.7              2
4261            11.99             12.0              1
3954             9.57             11.1              4
1903             9.97             11.2              7
899             11.88              8.0              2
4697             7.05             11.5              6
932             10.64             12.0              2
997              8.19             11.6              5
2015             8.25             13.7              3
4717             7.85             10.1              2
4002             5.72              7.5              8
860             11.82             11.3              3
3944             6.03             11.6             10
259              9.98             10.4              2
481              5.05             11.6              6
2072            11.10              4.2              9
299              9.32              6.6              9
3983             9.79              9.0              4
2454             7.43             10.0              8
3720             7.96              9.3              3
836              2.96              9.9              3
982             12.07              6.9              4
1540             6.85             10.7              5
2274             6.28              7.6              3
2552             6.55             10.9              3
3427             7.12             11.0              4
3032            10.74             12.5              3
727             12.95              7.8              5
945              8.69              9.2              6
3317             9.91             12.3              9
626              6.51             13.8              4
4358            12.57             11.6              3
4226             9.52              8.3              2
1396             8.61             12.2              4
4470             9.33             11.6              3
2818             6.44             11.4              9
1015            13.69             12.0              4
4746             8.11              7.5              7
517              8.21              7.6              1
33              13.20             12.6             10
4964            10.74              9.7              4
103              8.10             10.5              6
2157             9.55             11.3             11
1353            10.22             13.1              4
1693            11.91              6.3              7
4172            14.48             10.5              1
3619             9.23              5.9              2
     totalintlcharge numbercustomerservicecalls
2609            1.81                          4
4069            2.84                          1
2369            2.05                          1
1098            3.51                          1
1252            2.67                          3
634             4.21                          2
2097            4.35                          0
3911            2.30                          2
356             3.43                          1
4261            3.24                          2
3954            3.00                          1
1903            3.02                          1
899             2.16                          1
4697            3.11                          3
932             3.24                          1
997             3.13                          0
2015            3.70                          3
4717            2.73                          1
4002            2.03                          1
860             3.05                          3
3944            3.13                          2
259             2.81                          1
481             3.13                          1
2072            1.13                          2
299             1.78                          4
3983            2.43                          1
2454            2.70                          1
3720            2.51                          0
836             2.67                          1
982             1.86                          1
1540            2.89                          0
2274            2.05                          2
2552            2.94                          1
3427            2.97                          3
3032            3.38                          3
727             2.11                          1
945             2.48                          4
3317            3.32                          0
626             3.73                          3
4358            3.13                          2
4226            2.24                          3
1396            3.29                          0
4470            3.13                          1
2818            3.08                          1
1015            3.24                          0
4746            2.03                          1
517             2.05                          2
33              3.40                          3
4964            2.62                          2
103             2.84                          0
2157            3.05                          3
1353            3.54                          0
1693            1.70                          1
4172            2.84                          1
3619            1.59                          3
 [ reached 'max' / getOption("max.print") -- omitted 3945 rows ]
> prep_data[[2]]
    churn accountlength internationalplan voicemailplan
5      No            75               yes            no
11    Yes            65                no            no
21     No           147                no            no
22    Yes            77                no            no
24     No           111                no            no
28     No            54                no            no
37     No            36                no           yes
40     No           149                no            no
42    Yes           135               yes           yes
52     No            60                no            no
76     No            50                no            no
77    Yes            82                no            no
85    Yes           106                no            no
88     No           111                no            no
106    No            95                no            no
117    No            64                no            no
128   Yes            61                no           yes
129    No            92                no            no
133    No            78                no            no
145   Yes           117               yes            no
148    No            83               yes            no
150    No           145                no           yes
166    No            92                no           yes
172    No            64                no           yes
173    No            25                no            no
176    No            94                no            no
177    No            62                no            no
178    No           127                no            no
181    No            94               yes           yes
183    No            67                no           yes
192    No           130                no            no
193    No            80                no            no
198   Yes           208                no            no
200    No            63                no            no
206    No            66                no           yes
212    No           144               yes            no
223    No            65                no            no
226    No            65                no            no
230    No            45                no           yes
234    No            53                no            no
241    No           138                no            no
243    No            36                no            no
246    No            22                no            no
247    No           107                no           yes
248    No            51                no            no
250    No           119                no           yes
253    No            82                no            no
257    No           108                no            no
260    No            59                no            no
263    No           117                no            no
274    No           139                no            no
277    No           148               yes            no
281    No           143                no            no
282    No            81                no            no
283    No            48                no           yes
    numbervmailmessages totaldayminutes totaldaycalls
5                     0           166.7           113
11                    0           129.1           137
21                    0           155.1           117
22                    0            62.4            89
24                    0           110.4           103
28                    0           134.3            73
37                   30           146.3           128
40                    0           140.4            94
42                   41           173.1            85
52                    0           220.6            57
76                    0           157.1            90
77                    0           300.3           109
85                    0           210.6            96
88                    0           214.3           118
106                   0           238.1            65
117                   0           162.6            83
128                  27           187.5           124
129                   0            91.7            90
133                   0           231.0           115
145                   0           167.1            86
148                   0           271.5            87
150                  43           257.7            97
166                  33           243.1            92
172                  27           182.1            91
173                   0           119.3            87
176                   0           252.6           104
177                   0           147.1            91
178                   0           202.1           103
181                  23           197.1           125
183                  36           115.6           111
192                   0           176.9           109
193                   0           209.9            74
198                   0           326.5            67
200                   0            83.0            64
206                  36           106.7            76
212                   0           203.5           100
223                   0           136.1           112
226                   0           213.4           111
230                  22           196.6            84
234                   0           168.8            97
241                   0           220.2            89
243                   0           253.4            77
246                   0           110.3           107
247                  37            60.0           102
248                   0           214.8            94
250                  23           154.0           114
253                   0           207.0            90
257                   0           138.6           122
260                   0           155.2            79
263                   0           143.3           103
274                   0           192.8           104
277                   0           218.9            88
281                   0           172.3            97
282                   0           198.4            93
283                  37           211.7           115
    totaldaycharge totaleveminutes totalevecalls
5            28.34           148.3           122
11           21.95           228.5            83
21           26.37           239.7            93
22           10.61           169.9           121
24           18.77           137.3           102
28           22.83           155.5           100
37           24.87           162.5            80
40           23.87           271.8            92
42           29.43           203.9           107
52           37.50           211.1           115
76           26.71           223.3            72
77           51.05           181.0           100
85           35.80           249.2            85
88           36.43           208.5            76
106          40.48           187.2            98
117          27.64           152.3           109
128          31.88           146.6           103
129          15.59           193.7           123
133          39.27           230.4           140
145          28.41           177.5            87
148          46.16           216.3           126
150          43.81           162.1            95
166          41.33           213.8            92
172          30.96           169.7            98
173          20.28           211.5           101
176          42.94           169.0           125
177          25.01           190.4           107
178          34.36           229.4            86
181          33.51           214.5           136
183          19.65           237.7            94
192          30.07            90.7           104
193          35.68           195.1            77
198          55.51           176.3           113
200          14.11           177.0           106
206          18.14           209.8            77
212          34.60           247.6           103
223          23.14           272.9            96
226          36.28           234.5            94
230          33.42           313.2            92
234          28.70           220.3            87
241          37.43            88.3           125
243          43.08           182.4           151
246          18.75           166.5            93
247          10.20           102.2            80
248          36.52           149.7            58
250          26.18           278.0           137
253          35.19           232.9            83
257          23.56           172.3           117
260          26.38           235.3           123
263          24.36           211.3           108
274          32.78           234.4            96
277          37.21           208.0            85
281          29.29           174.0           108
282          33.73           210.9           108
283          35.99           159.9            84
    totalevecharge totalnightminutes totalnightcalls
5            12.61             186.9             121
11           19.42             208.8             111
21           20.37             208.8             133
22           14.44             209.6              64
24           11.67             189.6             105
28           13.22             102.1              68
37           13.81             129.3             109
40           23.10             188.3             108
42           17.33             122.2              78
52           17.94             249.0             129
76           18.98             181.4             111
77           15.39             270.1              73
85           21.18             191.4              88
88           17.72             182.4              98
106          15.91             190.0             115
117          12.95              57.5             122
128          12.46             225.7             129
129          16.46             175.0              86
133          19.58             261.4             120
145          15.09             249.4             132
148          18.39             121.1             105
150          13.78             286.9              86
166          18.17             228.7             104
172          14.42             164.7              86
173          17.98             268.9              86
176          14.37             170.9             106
177          16.18             195.2             115
178          19.50             195.2             113
181          18.23             282.2             103
183          20.20             169.9             103
192           7.71             238.0              69
193          16.58             208.2             119
198          14.99             181.7             102
200          15.05             245.7              89
206          17.83             190.4             117
212          21.05             194.3              94
223          23.20             220.2             104
226          19.93             250.1             123
230          26.62             163.3             108
234          18.73             154.3             113
241           7.51             195.3              79
243          15.50             275.8             103
246          14.15             202.3              96
247           8.69             261.8             106
248          12.72             283.4              66
250          23.63             228.4             112
253          19.80             172.4             108
257          14.65             231.6              92
260          20.00             169.4              80
263          17.96             185.2              96
274          19.92             203.2             101
277          17.68             203.3              99
281          14.79             188.2             119
282          17.93             193.3              71
283          13.59             144.1              80
    totalnightcharge totalintlminutes totalintlcalls
5               8.41             10.1              3
11              9.40             12.7              6
21              9.40             10.6              4
22              9.43              5.7              6
24              8.53              7.7              6
28              4.59             14.7              4
37              5.82             14.5              6
40              8.47             11.1              9
42              5.50             14.6             15
52             11.21              6.8              3
76              8.16              6.1              2
77             12.15             11.7              4
85              8.61             12.4              1
88              8.21             12.0              2
106             8.55             11.8              4
117             2.59             14.2              3
128            10.16              6.4              6
129             7.88              9.2              4
133            11.76              9.5              3
145            11.22             14.1              7
148             5.45             11.7              4
150            12.91             11.1              4
166            10.29             12.1              2
172             7.41             10.6              5
173            12.10             10.5              4
176             7.69             11.1              7
177             8.78             12.2              3
178             8.78             11.5              3
181            12.70              9.5              5
183             7.65              9.9             12
192            10.71              9.5              2
193             9.37              8.8              4
198             8.18             10.7              6
200            11.06             13.0              3
206             8.57             12.1              2
212             8.74             11.9             11
223             9.91              4.4              2
226            11.25              2.7              4
230             7.35             11.9              3
234             6.94             10.9              2
241             8.79             12.9              5
243            12.41              8.4              2
246             9.10              9.5              5
247            11.78             11.1              3
248            12.75             10.2              5
250            10.28             11.8              4
253             7.76              9.1              8
257            10.42              9.8              3
260             7.62              8.7              4
263             8.33             11.5              3
274             9.14             13.0              3
277             9.15             11.1              4
281             8.47             13.0              4
282             8.70             10.4              6
283             6.48             12.2              1
    totalintlcharge numbercustomerservicecalls
5              2.73                          3
11             3.43                          4
21             2.86                          0
22             1.54                          5
24             2.08                          2
28             3.97                          3
37             3.92                          0
40             3.00                          1
42             3.94                          0
52             1.84                          1
76             1.65                          1
77             3.16                          0
85             3.35                          2
88             3.24                          1
106            3.19                          4
117            3.83                          1
128            1.73                          4
129            2.48                          2
133            2.57                          1
145            3.81                          2
148            3.16                          1
150            3.00                          2
166            3.27                          2
172            2.86                          2
173            2.84                          3
176            3.00                          2
177            3.29                          0
178            3.11                          2
181            2.57                          4
183            2.67                          2
192            2.57                          1
193            2.38                          2
198            2.89                          2
200            3.51                          0
206            3.27                          1
212            3.21                          0
223            1.19                          1
226            0.73                          1
230            3.21                          0
234            2.94                          0
241            3.48                          0
243            2.27                          1
246            2.57                          0
247            3.00                          0
248            2.75                          0
250            3.19                          2
253            2.46                          3
257            2.65                          1
260            2.35                          1
263            3.11                          1
274            3.51                          3
277            3.00                          0
281            3.51                          2
282            2.81                          2
283            3.29                          1
 [ reached 'max' / getOption("max.print") -- omitted 945 rows ]
> 
> ## 2.train model
> set.seed(42)
> ctrl <- trainControl(method = "cv", 
+                      number = 5)
> 
> model <- train(churn ~ .,
+                    data = prep_data[[1]],
+                    method = "glm",
+                    trControl = ctrl)
> 
> ## print model
> model
Generalized Linear Model 

4000 samples
  17 predictor
   2 classes: 'No', 'Yes' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 3200, 3200, 3200, 3200, 3200 
Resampling results:

  Accuracy  Kappa   
  0.86525   0.230485

> 
> ## 3. score model
> pred_churn_glm <- predict(model, newdata = prep_data[[2]])
> 
> ## print pred_churn_glm
> pred_churn_glm
   [1] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
  [15] No  No  No  No  No  No  Yes No  No  No  No  No  No  No 
  [29] Yes No  No  No  No  No  No  No  No  No  No  No  No  No 
  [43] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
  [57] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
  [71] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
  [85] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
  [99] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [113] No  Yes No  No  No  No  No  No  No  No  No  No  No  No 
 [127] No  No  No  No  No  No  Yes No  No  No  No  No  No  No 
 [141] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [155] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [169] No  No  No  No  Yes No  No  No  No  No  No  No  No  No 
 [183] No  Yes No  No  No  Yes No  No  No  No  No  No  No  No 
 [197] No  No  No  No  No  No  No  No  No  No  Yes No  No  No 
 [211] No  No  No  No  No  No  No  Yes No  No  No  No  Yes No 
 [225] No  No  No  No  No  Yes No  No  No  No  No  No  No  No 
 [239] No  No  No  No  No  No  Yes No  No  No  No  No  No  No 
 [253] No  No  No  No  No  Yes No  Yes No  No  No  No  No  No 
 [267] No  No  No  No  No  No  No  No  No  Yes No  No  Yes No 
 [281] No  No  No  No  No  No  No  No  Yes No  No  No  No  No 
 [295] No  No  Yes No  No  No  No  No  No  No  Yes No  No  No 
 [309] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [323] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [337] No  No  No  Yes No  No  No  No  No  No  No  No  No  No 
 [351] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [365] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [379] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [393] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [407] No  No  No  No  No  No  No  No  No  No  No  No  No  Yes
 [421] No  No  No  No  No  No  Yes Yes No  No  No  No  No  No 
 [435] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [449] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [463] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [477] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [491] No  No  No  No  No  No  No  Yes Yes No  No  No  No  No 
 [505] No  No  No  Yes No  No  No  No  No  No  No  No  No  No 
 [519] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [533] No  Yes No  No  No  No  No  No  No  No  No  No  No  No 
 [547] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [561] No  No  No  No  No  Yes No  No  No  No  No  No  No  No 
 [575] No  Yes No  No  No  No  No  No  No  Yes No  No  No  No 
 [589] No  No  No  No  No  No  No  No  No  No  No  Yes No  No 
 [603] No  No  No  No  No  Yes No  No  No  No  No  No  No  No 
 [617] Yes No  Yes No  No  No  No  No  No  Yes No  No  No  No 
 [631] No  No  Yes Yes No  No  No  No  No  No  No  No  No  Yes
 [645] Yes No  No  No  No  No  No  No  No  No  No  No  No  No 
 [659] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [673] No  No  No  No  No  Yes No  No  Yes No  No  No  No  No 
 [687] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [701] No  No  No  No  No  No  No  No  Yes No  No  No  No  No 
 [715] No  No  No  No  Yes No  No  No  No  Yes No  No  No  Yes
 [729] Yes No  No  No  No  Yes No  No  No  No  No  No  No  No 
 [743] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [757] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [771] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [785] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [799] No  No  No  No  No  No  No  No  No  Yes No  No  No  No 
 [813] No  No  No  No  No  No  No  Yes No  No  No  No  No  No 
 [827] No  Yes No  No  No  No  No  No  No  No  No  No  No  No 
 [841] No  No  Yes No  No  No  No  No  No  No  No  No  No  No 
 [855] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [869] No  No  No  Yes No  No  No  Yes No  No  Yes No  No  No 
 [883] No  No  No  No  Yes No  No  No  No  No  No  No  No  No 
 [897] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [911] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [925] No  No  No  No  Yes No  No  No  No  No  No  No  No  No 
 [939] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [953] No  No  No  No  No  No  Yes No  No  No  No  No  No  No 
 [967] No  No  No  No  No  Yes No  No  No  No  No  No  No  No 
 [981] No  No  No  No  No  No  No  No  No  No  No  No  No  No 
 [995] No  No  No  No  No  No 
Levels: No Yes
> 
> ## 4. evaluate model
> actual_churn <- prep_data[[2]]$churn
> 
> ## print actual_churn
> actual_churn
   [1] "No"  "Yes" "No"  "Yes" "No"  "No"  "No"  "No"  "Yes"
  [10] "No"  "No"  "Yes" "Yes" "No"  "No"  "No"  "Yes" "No" 
  [19] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
  [28] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
  [37] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
  [46] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
  [55] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
  [64] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes"
  [73] "No"  "No"  "Yes" "No"  "No"  "Yes" "No"  "No"  "No" 
  [82] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
  [91] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [100] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [109] "No"  "Yes" "No"  "No"  "No"  "Yes" "Yes" "No"  "No" 
 [118] "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [127] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "Yes"
 [136] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [145] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [154] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "Yes"
 [163] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [172] "No"  "Yes" "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [181] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [190] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [199] "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes"
 [208] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [217] "No"  "Yes" "Yes" "No"  "No"  "No"  "Yes" "No"  "No" 
 [226] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [235] "No"  "Yes" "No"  "Yes" "No"  "Yes" "No"  "Yes" "No" 
 [244] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [253] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [262] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [271] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [280] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [289] "Yes" "No"  "No"  "Yes" "No"  "No"  "No"  "Yes" "No" 
 [298] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [307] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [316] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
 [325] "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [334] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [343] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [352] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
 [361] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [370] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes"
 [379] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [388] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "Yes"
 [397] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [406] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [415] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "Yes"
 [424] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [433] "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [442] "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "Yes"
 [451] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [460] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [469] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [478] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "Yes" "No" 
 [487] "No"  "No"  "No"  "No"  "No"  "Yes" "Yes" "No"  "No" 
 [496] "Yes" "No"  "No"  "Yes" "Yes" "No"  "No"  "No"  "No" 
 [505] "No"  "No"  "No"  "Yes" "Yes" "No"  "No"  "No"  "No" 
 [514] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "Yes" "Yes"
 [523] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [532] "No"  "No"  "Yes" "No"  "No"  "Yes" "No"  "No"  "No" 
 [541] "Yes" "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [550] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
 [559] "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [568] "No"  "Yes" "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [577] "No"  "No"  "Yes" "Yes" "No"  "No"  "No"  "Yes" "No" 
 [586] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [595] "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [604] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [613] "No"  "No"  "No"  "No"  "Yes" "No"  "Yes" "No"  "No" 
 [622] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "Yes" "No" 
 [631] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [640] "No"  "No"  "No"  "No"  "Yes" "Yes" "No"  "No"  "No" 
 [649] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [658] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [667] "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [676] "No"  "Yes" "Yes" "No"  "No"  "Yes" "Yes" "No"  "No" 
 [685] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [694] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [703] "No"  "No"  "No"  "Yes" "No"  "Yes" "Yes" "No"  "No" 
 [712] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
 [721] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [730] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [739] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [748] "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [757] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [766] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [775] "Yes" "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [784] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [793] "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [802] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [811] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [820] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [829] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "Yes" "Yes"
 [838] "No"  "No"  "No"  "No"  "Yes" "Yes" "No"  "Yes" "No" 
 [847] "No"  "No"  "Yes" "No"  "No"  "No"  "Yes" "No"  "No" 
 [856] "No"  "Yes" "No"  "No"  "No"  "No"  "Yes" "No"  "No" 
 [865] "Yes" "No"  "No"  "No"  "Yes" "No"  "No"  "Yes" "No" 
 [874] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
 [883] "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "Yes" "No" 
 [892] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No" 
 [901] "Yes" "No"  "Yes" "No"  "No"  "No"  "No"  "No"  "No" 
 [910] "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No"  "No" 
 [919] "No"  "Yes" "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [928] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [937] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [946] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "Yes"
 [955] "No"  "No"  "No"  "No"  "Yes" "No"  "No"  "No"  "No" 
 [964] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "Yes"
 [973] "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No"  "No" 
 [982] "No"  "No"  "No"  "No"  "No"  "Yes" "No"  "Yes" "No" 
 [991] "Yes" "No"  "No"  "No"  "No"  "No"  "No"  "Yes" "No" 
[1000] "No" 
> 
> ##find error values 
> mean(pred_churn_glm == actual_churn)
[1] 0.865
